---
title: "__Temporal Overlap Analyses of Tropical Arctiidae Species__"
author: "Jonas Geschke and Sören Greule"
date: "Winter semester 2015/16"
output:
  pdf_document:
    toc: yes
documentclass: article
classoption: a4paper
---

- - - - - - - - - -

# Introduction
_This skript is the outcome of a selected topic within the MSc Environmental Scienes, Faculty of Environment and Natural Resources, University of Freiburg. The selected topic is supervised by Dr Tim Burzlaff._

The script is about the analysis of monitoring data from both Costa Rica (locations: El Bosque Nuevo Butterfly Farm and the private home of P. Gloor, near San José) and Peru (location: Panguana). The main interest is about looking for existing temporal niche and community interactions within species of Arctiinae and Ithomiini species.

The main analysis approach comes from the paper "Temporal Overlap and Co-Occurrence in a Guild of Sub-Tropical Tephritid Fruit Flies" by Lopes GN, Souza-Filho MF, Gotelli NJ, Lemos LJU, Godoy WAC and Zucchi RA (2015) in PLoS ONE 10(7): e0132124, [doi:10.1371/journal.pone.0132124](http://journals.plos.org/plosone/article?id=10.1371/journal.pone.0132124). We concentrate on their idea about the niche overlap analyses.
The data used in our analyses come from the long-term monitoring trapping of the Chair of Forest Zoology and Entomology, University of Freiburg, and was undertaken by several staff members and student assistants.


- - - - - - - - - -
# Script

## Defining general settings

In here, we set the working directory, which one might have to adapt or change in order to get this skript running. Further, we provide the code for installing all needed packages and activate them.

```{r, message=FALSE}
# Setting the working directory
setwd("~/Studium/MSc/3. Semester/Temporal_niche_analyses/Git")

###### Installing packages (if needed: delete the hashtag in front of the code!) ######
# install.packages("lubridate")
# install.packages("ggplot2")
# install.packages("reshape")
# install.packages("EcoSimR")
#######################################################################################

# Loading packages
library(lubridate)
library(ggplot2)
library(reshape)
library(EcoSimR)
```


## Revising the original data

Now we read the original data and directly resave it as an archive datafile. In the working datafile `Gdata`, we rename the columns for easier handling.

```{r, results='hide'}
# Load the original datatable
Gdata <- read.csv2("IndID Auszug 01.Sep 15 All In.csv",
                   header = T,
                   sep = ";",
                   na.strings = "")

# Resaving original datatable as archive table
GdataORIG <- Gdata

# Show original column names
names(Gdata)

# Renaming columns
names(Gdata)[names(Gdata) == "DataSet"]     <- "taxon"
names(Gdata)[names(Gdata) == "Bemerkung1"]  <- "notes"
names(Gdata)[names(Gdata) == "day_night"]   <- "light"
names(Gdata)[names(Gdata) == "Art."]        <- "spp"
names(Gdata)[names(Gdata) == "FangDatum"]   <- "date"
names(Gdata)[names(Gdata) == "FangOrt"]     <- "site"
names(Gdata)[names(Gdata) == "FangZeit"]    <- "time"
names(Gdata)[names(Gdata) == "IndID"]       <- "iid"
names(Gdata)[names(Gdata) == "Sex"]         <- "sex"
names(Gdata)[names(Gdata) == "Typ1"]        <- "trap"
names(Gdata)[names(Gdata) == "Vertrauen"]   <- "trust"

# Control new column names
names(Gdata)
```


Now we have a table that we can further process.
First of all, we do not need the columns "notes" and "iid" (individual ID) and correct some oversight mistakes within the datatable. Also, we do have 2 levels of trust within the whole datatable - 1 and 2. Trust level "2" is good, level "1" not so much. Those datapoint with no trust level at all are deleted at once.

```{r, results='hide'}
# Deleting the "notes" and "iid" columns
Gdata$notes <- NULL
Gdata$iid <- NULL
names(Gdata)

# Delete all rows, where the trust level is equal 0 (= NA)
Gdata <- subset(Gdata, Gdata$trust != "NA")
Gdata <- droplevels(Gdata)
summary(Gdata)

# Correcting the "light" cells
summary(Gdata$light)
Gdata$light[Gdata$light == "atg"]           <- "tag"
Gdata$light[Gdata$light == "tag "]          <- "tag"
Gdata$light[Gdata$light == "nacht\n"]       <- "nacht"
Gdata$light[Gdata$light == "nachts"]        <- "nacht"
Gdata <- droplevels(Gdata)
summary(Gdata$light)
### There are further values we need to think about! ("m" and time)

# Correcting the "site" cells
summary(Gdata$site)
Gdata$site[Gdata$site == "CR"]              <- "EBN"
Gdata$site[Gdata$site == "EBN\n"]           <- "EBN"
Gdata$site[Gdata$site == "GLOOR"]           <- "PG"
Gdata <- droplevels(Gdata)
summary(Gdata$site)

# Correcting the "sex" cells
summary(Gdata$sex)
Gdata$sex[Gdata$sex == "f "]                <- "f"
Gdata$sex[Gdata$sex == "w"]                 <- "f"
Gdata <- droplevels(Gdata)
summary(Gdata$sex)
### There are further values we need to think about! ("?" and "f?")
```


## Processing the data for further uses

For getting an overview plot of our data, we sort the whole datatable by date. Thus, we add two columns. Each one for the year and for the month. Afterwards we would like to produce a first plot, so we also add two columns containing information about the month and the day number.

```{r, results='hide'}
# Creating the column "year"
Gdata <- cbind(Gdata, "year" = format(as.Date(Gdata$date, "%d.%m.%Y"), "%Y"))

# Creating the column "month"
Gdata <- cbind(Gdata, "month" = format(as.Date(Gdata$date, "%d.%m.%Y"), "%m"))

# Creating a column, in which the month is written out
Gdata <- cbind(Gdata, "monat" = format(as.Date(Gdata$date, "%d.%m.%Y"), "%B"))

# Creating a column, in which for each day we define the day number within a year
# Here, the package "lubridate" is needed
Gdata <- cbind(Gdata, "day_nr" = yday(as.Date(Gdata$date, "%d.%m.%Y")))

# Sorting whole datatable by month
Gdata <- Gdata[order(Gdata$month),]
```


Also, for later `cast`-processing, we create a "value" column.

```{r, results='hide'}
# Creating the "value" column, which contains availability information (yes/no)
Gdata <- cbind(Gdata, "value" = 1)
```




Now that we organized the datatable for a bit, we are ready to create a first overview plot about how many individuals were trapped thoughout the years.

```{r, results='hide', fig.show='hide'}
# Creating a colour palette for the plot
colourpalette10 <- c("#596137",
                     "#BD57C7",
                     "#7FCD4E",
                     "#BF543A",
                     "#A3B1BF",
                     "#CFB253",
                     "#C55783",
                     "#4F3647",
                     "#7374BE",
                     "#84CAA0")

# Creating plot0. This plot shows the whole data (also NAs)!
# Here, the package "ggplot2" is needed
plotORIG <- ggplot(Gdata, aes(x = day_nr, fill = monat))+
  scale_fill_manual(name = "Month", values = colourpalette10,
                    breaks = c("Januar",
                               "Februar",
                               "März",
                               "April",
                               "Mai",
                               "Juni",
                               "Juli",
                               "August",
                               "September",
                               "Oktober"))+
  geom_histogram(binwidth = 1)+
  facet_wrap(site ~ year, ncol = 1)+
  theme(axis.text.x = element_text(angle = 90, hjust = 1))+
  labs(title = "Number of trapped individuals per site, including NAs",
       x = "Day of the year",
       y = "No of trapped Arctiinae individuals")+
  scale_x_continuous(expand = c(0,0),
                     breaks = seq(0, 365, 7),
                     limits = c(0, 365))
plotORIG
```


As we can see in this `plotORIG`, is does not make sense to include those data points, where we neither know the trapping site nor the trapping year.
So next, we delete those rows out of the datatable where this information is not noted. Further, we would like to have data rows with Arctiinae and 2nd trust level only. So we delete all other datapoints. Finally, as it does not make sense to keep them, we delete all rows where we do not know the species number.

```{r, results='hide'}
# Deleting all rows, where the taxon is not "Arct", the "spp" and "site" are not noted, the trust level is not "2" and where we dont have a specific trapping "year" noted
Gdata <- subset(Gdata, taxon == "Arct")
Gdata <- subset(Gdata, spp != "NA")
Gdata <- subset(Gdata, site != "NA")
Gdata <- subset(Gdata, trust == "2")
Gdata <- subset(Gdata, year != "NA")
Gdata <- droplevels(Gdata)
```

Now, we repeat plotting this. This plot includes all the datapoints that probably are more interesting to look at, as all basic information are given we need for further analyses and interpretation.

```{r, fig.cap='plot2', fig.ext='pdf', fig.height=27, fig.width=17, dpi=300}
# Creating overview_plot
# Here, the package "ggplot2" is needed
overview_plot <- ggplot(Gdata, aes(x = day_nr, fill = monat))+
  scale_fill_manual(name = "Month", values = colourpalette10,
                    breaks = c("Januar",
                               "Februar",
                               "März",
                               "April",
                               "Mai",
                               "Juni",
                               "Juli",
                               "August",
                               "September",
                               "Oktober"))+
  geom_histogram(binwidth = 1)+
  facet_wrap(site ~ year, ncol = 1)+
  theme(axis.text.x = element_text(angle = 90, hjust = 1))+
  labs(title = "Number of trapped Arctiinae individuals 2007-2015
       in EBN and 2010, 2013 & 2015 in Peru Panguana",
       x = "Day of the year",
       y = "No of trapped Arctiinae individuals")+
  scale_x_continuous(expand = c(0,0),
                     breaks = seq(0, 365, 7),
                     limits = c(0, 365))
overview_plot
```



## Preparing the data for further analyses

Creating subset datasets for each site, `Gdata_EBN` and `Gdata_PP`.

```{r, results='hide'}
# Creating a subset, which only contains data from EBN
Gdata_EBN <- subset(Gdata, site == "EBN")
Gdata_PP <- subset(Gdata, site == "PP")

# Creating subsets for each year per site
EBN_2007 <- subset(Gdata_EBN, year == "2007")
EBN_2008 <- subset(Gdata_EBN, year == "2008")
EBN_2009 <- subset(Gdata_EBN, year == "2009")
EBN_2010 <- subset(Gdata_EBN, year == "2010")
EBN_2011 <- subset(Gdata_EBN, year == "2011")
EBN_2012 <- subset(Gdata_EBN, year == "2012")
EBN_2013 <- subset(Gdata_EBN, year == "2013")
EBN_2014 <- subset(Gdata_EBN, year == "2014")
EBN_2015 <- subset(Gdata_EBN, year == "2015")
PP_2010 <- subset(Gdata_PP, year == "2010")
PP_2013 <- subset(Gdata_PP, year == "2013")
PP_2015 <- subset(Gdata_PP, year == "2015")
```


### Subsetting function bases

```{r, eval=FALSE}
# dataset_split <- function(data, light = FALSE, site = FALSE, trap = FALSE, month_start = "01", month_end = "12"){}

# sex_rowsplit <- function(data){}

# column_split <- function(data, light = FALSE, base_interval = "days"){}
```

```{r, eval=FALSE}
# subsetting(Gdata2, trap = "L", month_start = "05", month_end = "11")
```


### Processing the datasets into the Pianka and Czekanowski input format

`EBN_cast`
```{r, results='hide'}
# Creating a table in which we have relative values lateron
# For now using the Gdata_EBN dataset only
# Here, the package "reshape" is needed
EBN_cast <- cast(aggregate(Gdata_EBN$value,
                       by = list(Gdata_EBN$spp, Gdata_EBN$date),
                       FUN = "sum",
                       na.rm = T),
                  Group.1 ~ Group.2,
                  value = "x",
                  "sum")

# Changing the species to front column and deleting the species column
rownames(EBN_cast) <- EBN_cast$Group.1
EBN_cast <- EBN_cast[,-1]
```

```{r, eval=FALSE}
# test <- prop.table(as.matrix(EBN_cast), 1)
```


Creating subset-cast datasets for each year and site:

`EBN_2007_cast`
```{r, results='hide'}
# Creating a table in which we have relative values lateron
# For now using the EBN_2007 dataset only
# Here, the package "reshape" is needed
EBN_2007_cast <- cast(aggregate(EBN_2007$value,
                       by = list(EBN_2007$spp, EBN_2007$date),
                       FUN = "sum",
                       na.rm = T),
                  Group.1 ~ Group.2,
                  value = "x",
                  "sum")

# Changing the species to front column and deleting the species column
rownames(EBN_2007_cast) <- EBN_2007_cast$Group.1
EBN_2007_cast <- EBN_2007_cast[,-1]
```

`EBN_2008_cast`
```{r, results='hide'}
# Creating a table in which we have relative values lateron
# For now using the EBN_2008 dataset only
# Here, the package "reshape" is needed
EBN_2008_cast <- cast(aggregate(EBN_2008$value,
                       by = list(EBN_2008$spp, EBN_2008$date),
                       FUN = "sum",
                       na.rm = T),
                  Group.1 ~ Group.2,
                  value = "x",
                  "sum")

# Changing the species to front column and deleting the species column
rownames(EBN_2008_cast) <- EBN_2008_cast$Group.1
EBN_2008_cast <- EBN_2008_cast[,-1]
```

`EBN_2009_cast`
```{r, results='hide'}
# Creating a table in which we have relative values lateron
# For now using the EBN_2009 dataset only
# Here, the package "reshape" is needed
EBN_2009_cast <- cast(aggregate(EBN_2009$value,
                       by = list(EBN_2009$spp, EBN_2009$date),
                       FUN = "sum",
                       na.rm = T),
                  Group.1 ~ Group.2,
                  value = "x",
                  "sum")

# Changing the species to front column and deleting the species column
rownames(EBN_2009_cast) <- EBN_2009_cast$Group.1
EBN_2009_cast <- EBN_2009_cast[,-1]
```

`EBN_2010_cast`
```{r, results='hide'}
# Creating a table in which we have relative values lateron
# For now using the EBN_2010 dataset only
# Here, the package "reshape" is needed
EBN_2010_cast <- cast(aggregate(EBN_2010$value,
                       by = list(EBN_2010$spp, EBN_2010$date),
                       FUN = "sum",
                       na.rm = T),
                  Group.1 ~ Group.2,
                  value = "x",
                  "sum")

# Changing the species to front column and deleting the species column
rownames(EBN_2010_cast) <- EBN_2010_cast$Group.1
EBN_2010_cast <- EBN_2010_cast[,-1]
```

`EBN_2011_cast`
```{r, results='hide'}
# Creating a table in which we have relative values lateron
# For now using the Gdata_EBN_2011 dataset only
# Here, the package "reshape" is needed
EBN_2011_cast <- cast(aggregate(EBN_2011$value,
                       by = list(EBN_2011$spp, EBN_2011$date),
                       FUN = "sum",
                       na.rm = T),
                  Group.1 ~ Group.2,
                  value = "x",
                  "sum")

# Changing the species to front column and deleting the species column
rownames(EBN_2011_cast) <- EBN_2011_cast$Group.1
EBN_2011_cast <- EBN_2011_cast[,-1]
```

`EBN_2012_cast`
```{r, results='hide'}
# Creating a table in which we have relative values lateron
# For now using the EBN_2012 dataset only
# Here, the package "reshape" is needed
EBN_2012_cast <- cast(aggregate(EBN_2012$value,
                       by = list(EBN_2012$spp, EBN_2012$date),
                       FUN = "sum",
                       na.rm = T),
                  Group.1 ~ Group.2,
                  value = "x",
                  "sum")

# Changing the species to front column and deleting the species column
rownames(EBN_2012_cast) <- EBN_2012_cast$Group.1
EBN_2012_cast <- EBN_2012_cast[,-1]
```

`EBN_2013_cast`
```{r, results='hide'}
# Creating a table in which we have relative values lateron
# For now using the EBN_2013 dataset only
# Here, the package "reshape" is needed
EBN_2013_cast <- cast(aggregate(EBN_2013$value,
                       by = list(EBN_2013$spp, EBN_2013$date),
                       FUN = "sum",
                       na.rm = T),
                  Group.1 ~ Group.2,
                  value = "x",
                  "sum")

# Changing the species to front column and deleting the species column
rownames(EBN_2013_cast) <- EBN_2013_cast$Group.1
EBN_2013_cast <- EBN_2013_cast[,-1]
```

`EBN_2014_cast`
```{r, results='hide'}
# Creating a table in which we have relative values lateron
# For now using the EBN_2014 dataset only
# Here, the package "reshape" is needed
EBN_2014_cast <- cast(aggregate(EBN_2014$value,
                       by = list(EBN_2014$spp, EBN_2014$date),
                       FUN = "sum",
                       na.rm = T),
                  Group.1 ~ Group.2,
                  value = "x",
                  "sum")

# Changing the species to front column and deleting the species column
rownames(EBN_2014_cast) <- EBN_2014_cast$Group.1
EBN_2014_cast <- EBN_2014_cast[,-1]
```

`EBN_2015_cast`
```{r, results='hide'}
# Creating a table in which we have relative values lateron
# For now using the EBN_2015 dataset only
# Here, the package "reshape" is needed
EBN_2015_cast <- cast(aggregate(EBN_2015$value,
                       by = list(EBN_2015$spp, EBN_2015$date),
                       FUN = "sum",
                       na.rm = T),
                  Group.1 ~ Group.2,
                  value = "x",
                  "sum")

# Changing the species to front column and deleting the species column
rownames(EBN_2015_cast) <- EBN_2015_cast$Group.1
EBN_2015_cast <- EBN_2015_cast[,-1]
```

`PP_2010_cast`
```{r, results='hide'}
# Creating a table in which we have relative values lateron
# For now using the PP_2010 dataset only
# Here, the package "reshape" is needed
PP_2010_cast <- cast(aggregate(PP_2010$value,
                       by = list(PP_2010$spp, PP_2010$date),
                       FUN = "sum",
                       na.rm = T),
                  Group.1 ~ Group.2,
                  value = "x",
                  "sum")

# Changing the species to front column and deleting the species column
rownames(PP_2010_cast) <- PP_2010_cast$Group.1
PP_2010_cast <- PP_2010_cast[,-1]
```

`PP_2013_cast`
```{r, results='hide'}
# Creating a table in which we have relative values lateron
# For now using the PP_2013 dataset only
# Here, the package "reshape" is needed
PP_2013_cast <- cast(aggregate(PP_2013$value,
                       by = list(PP_2013$spp, PP_2013$date),
                       FUN = "sum",
                       na.rm = T),
                  Group.1 ~ Group.2,
                  value = "x",
                  "sum")

# Changing the species to front column and deleting the species column
rownames(PP_2013_cast) <- PP_2013_cast$Group.1
PP_2013_cast <- PP_2013_cast[,-1]
```

`PP_2015_cast`
```{r, results='hide'}
# Creating a table in which we have relative values lateron
# For now using the PP_2015 dataset only
# Here, the package "reshape" is needed
PP_2015_cast <- cast(aggregate(PP_2015$value,
                       by = list(PP_2015$spp, PP_2015$date),
                       FUN = "sum",
                       na.rm = T),
                  Group.1 ~ Group.2,
                  value = "x",
                  "sum")

# Changing the species to front column and deleting the species column
rownames(PP_2015_cast) <- PP_2015_cast$Group.1
PP_2015_cast <- PP_2015_cast[,-1]
```



### Running the Pianka and Czekanowski niche overlap probability analyses for each year and site

For EBN, 2007.
```{r, results='hide'}
# Pianka and Czekanowski analysis for EBN, 2007

# Setting the input data
EBN07 <- EBN_2007_cast/rowSums(EBN_2007_cast)

# Pianka
EBN_2007_P <- cbind(t(combn(rownames(EBN07), 2)), 0)
    for (i in 1:nrow(EBN_2007_P)) EBN_2007_P[i, 3] <- sum(EBN07[EBN_2007_P[i, 
        1], ] * EBN07[EBN_2007_P[i, 2], ])/sqrt(sum(EBN07[EBN_2007_P[i, 1], 
        ]^2) * sum(EBN07[EBN_2007_P[i, 2], ]^2))

# Czekanowski
EBN_2007_C <- cbind(t(combn(rownames(EBN07), 2)), 0)
    for (i in 1:nrow(EBN_2007_C)) EBN_2007_C[i, 3] <- 1 - 0.5 * sum(abs((EBN07[EBN_2007_C[i, 
        1], ] - EBN07[EBN_2007_C[i, 2], ])))

plot(EBN_2007_P[,3], EBN_2007_C[,3],
     main = "Niche Overlap Probabilities, EBN in 2007",
     xlab =  "Pianka",
     ylab = "Czekanowski",
     pch = 3)
  mtext("(Each cross symbolizes one pair of species)")
```

For EBN, 2008.
```{r, results='hide'}
# Pianka and Czekanowski analysis for EBN, 2008

# Setting the input data
EBN08 <- EBN_2008_cast/rowSums(EBN_2008_cast)

# Pianka
EBN_2008_P <- cbind(t(combn(rownames(EBN08), 2)), 0)
    for (i in 1:nrow(EBN_2008_P)) EBN_2008_P[i, 3] <- sum(EBN08[EBN_2008_P[i, 
        1], ] * EBN08[EBN_2008_P[i, 2], ])/sqrt(sum(EBN08[EBN_2008_P[i, 1], 
        ]^2) * sum(EBN08[EBN_2008_P[i, 2], ]^2))

# Czekanowski
EBN_2008_C <- cbind(t(combn(rownames(EBN08), 2)), 0)
    for (i in 1:nrow(EBN_2008_C)) EBN_2008_C[i, 3] <- 1 - 0.5 * sum(abs((EBN08[EBN_2008_C[i, 
        1], ] - EBN08[EBN_2008_C[i, 2], ])))

plot(EBN_2008_P[,3], EBN_2008_C[,3],
     main = "Niche Overlap Probabilities, EBN in 2008",
     xlab =  "Pianka",
     ylab = "Czekanowski",
     pch = 3)
  mtext("(Each cross symbolizes one pair of species)")
```

For EBN, 2009.
```{r, results='hide'}
# Pianka and Czekanowski analysis for EBN, 2009

# Setting the input data
EBN09 <- EBN_2009_cast/rowSums(EBN_2009_cast)

# Pianka
EBN_2009_P <- cbind(t(combn(rownames(EBN09), 2)), 0)
    for (i in 1:nrow(EBN_2009_P)) EBN_2009_P[i, 3] <- sum(EBN09[EBN_2009_P[i, 
        1], ] * EBN09[EBN_2009_P[i, 2], ])/sqrt(sum(EBN09[EBN_2009_P[i, 1], 
        ]^2) * sum(EBN09[EBN_2009_P[i, 2], ]^2))

# Czekanowski
EBN_2009_C <- cbind(t(combn(rownames(EBN09), 2)), 0)
    for (i in 1:nrow(EBN_2009_C)) EBN_2009_C[i, 3] <- 1 - 0.5 * sum(abs((EBN09[EBN_2009_C[i, 
        1], ] - EBN09[EBN_2009_C[i, 2], ])))

plot(EBN_2009_P[,3], EBN_2009_C[,3],
     main = "Niche Overlap Probabilities, EBN in 2009",
     xlab =  "Pianka",
     ylab = "Czekanowski",
     pch = 3)
  mtext("(Each cross symbolizes one pair of species)")
```

For EBN, 2010.
```{r, results='hide'}
# Pianka and Czekanowski analysis for EBN, 2010

# Setting the input data
EBN10 <- EBN_2010_cast/rowSums(EBN_2010_cast)

# Pianka
EBN_2010_P <- cbind(t(combn(rownames(EBN10), 2)), 0)
    for (i in 1:nrow(EBN_2010_P)) EBN_2010_P[i, 3] <- sum(EBN10[EBN_2010_P[i, 
        1], ] * EBN10[EBN_2010_P[i, 2], ])/sqrt(sum(EBN10[EBN_2010_P[i, 1], 
        ]^2) * sum(EBN10[EBN_2010_P[i, 2], ]^2))

# Czekanowski
EBN_2010_C <- cbind(t(combn(rownames(EBN10), 2)), 0)
    for (i in 1:nrow(EBN_2010_C)) EBN_2010_C[i, 3] <- 1 - 0.5 * sum(abs((EBN10[EBN_2010_C[i, 
        1], ] - EBN10[EBN_2010_C[i, 2], ])))

plot(EBN_2010_P[,3], EBN_2010_C[,3],
     main = "Niche Overlap Probabilities, EBN in 2010",
     xlab =  "Pianka",
     ylab = "Czekanowski",
     pch = 3)
  mtext("(Each cross symbolizes one pair of species)")
```

For EBN, 2011.
```{r, results='hide'}
# Pianka and Czekanowski analysis for EBN, 2011

# Setting the input data
EBN11 <- EBN_2011_cast/rowSums(EBN_2011_cast)

# Pianka
EBN_2011_P <- cbind(t(combn(rownames(EBN11), 2)), 0)
    for (i in 1:nrow(EBN_2011_P)) EBN_2011_P[i, 3] <- sum(EBN11[EBN_2011_P[i, 
        1], ] * EBN11[EBN_2011_P[i, 2], ])/sqrt(sum(EBN11[EBN_2011_P[i, 1], 
        ]^2) * sum(EBN11[EBN_2011_P[i, 2], ]^2))

# Czekanowski
EBN_2011_C <- cbind(t(combn(rownames(EBN11), 2)), 0)
    for (i in 1:nrow(EBN_2011_C)) EBN_2011_C[i, 3] <- 1 - 0.5 * sum(abs((EBN11[EBN_2011_C[i, 
        1], ] - EBN11[EBN_2011_C[i, 2], ])))

plot(EBN_2011_P[,3], EBN_2011_C[,3],
     main = "Niche Overlap Probabilities, EBN in 2011",
     xlab =  "Pianka",
     ylab = "Czekanowski",
     pch = 3)
  mtext("(Each cross symbolizes one pair of species)")
```

For EBN, 2012.
```{r, results='hide'}
# Pianka and Czekanowski analysis for EBN, 2012

# Setting the input data
EBN12 <- EBN_2012_cast/rowSums(EBN_2012_cast)

# Pianka
EBN_2012_P <- cbind(t(combn(rownames(EBN12), 2)), 0)
    for (i in 1:nrow(EBN_2012_P)) EBN_2012_P[i, 3] <- sum(EBN12[EBN_2012_P[i, 
        1], ] * EBN12[EBN_2012_P[i, 2], ])/sqrt(sum(EBN12[EBN_2012_P[i, 1], 
        ]^2) * sum(EBN12[EBN_2012_P[i, 2], ]^2))

# Czekanowski
EBN_2012_C <- cbind(t(combn(rownames(EBN12), 2)), 0)
    for (i in 1:nrow(EBN_2012_C)) EBN_2012_C[i, 3] <- 1 - 0.5 * sum(abs((EBN12[EBN_2012_C[i, 
        1], ] - EBN12[EBN_2012_C[i, 2], ])))

plot(EBN_2012_P[,3], EBN_2012_C[,3],
     main = "Niche Overlap Probabilities, EBN in 2012",
     xlab =  "Pianka",
     ylab = "Czekanowski",
     pch = 3)
  mtext("(Each cross symbolizes one pair of species)")
```

For EBN, 2013.
```{r, results='hide'}
# Pianka and Czekanowski analysis for EBN, 2013

# Setting the input data
EBN13 <- EBN_2013_cast/rowSums(EBN_2013_cast)

# Pianka
EBN_2013_P <- cbind(t(combn(rownames(EBN13), 2)), 0)
    for (i in 1:nrow(EBN_2013_P)) EBN_2013_P[i, 3] <- sum(EBN13[EBN_2013_P[i, 
        1], ] * EBN13[EBN_2013_P[i, 2], ])/sqrt(sum(EBN13[EBN_2013_P[i, 1], 
        ]^2) * sum(EBN13[EBN_2013_P[i, 2], ]^2))

# Czekanowski
EBN_2013_C <- cbind(t(combn(rownames(EBN13), 2)), 0)
    for (i in 1:nrow(EBN_2013_C)) EBN_2013_C[i, 3] <- 1 - 0.5 * sum(abs((EBN13[EBN_2013_C[i, 
        1], ] - EBN13[EBN_2013_C[i, 2], ])))

plot(EBN_2013_P[,3], EBN_2013_C[,3],
     main = "Niche Overlap Probabilities, EBN in 2013",
     xlab =  "Pianka",
     ylab = "Czekanowski",
     pch = 3)
  mtext("(Each cross symbolizes one pair of species)")
```

For EBN, 2014.
```{r, results='hide'}
# Pianka and Czekanowski analysis for EBN, 2014

# Setting the input data
EBN14 <- EBN_2014_cast/rowSums(EBN_2014_cast)

# Pianka
EBN_2014_P <- cbind(t(combn(rownames(EBN14), 2)), 0)
    for (i in 1:nrow(EBN_2014_P)) EBN_2014_P[i, 3] <- sum(EBN14[EBN_2014_P[i, 
        1], ] * EBN14[EBN_2014_P[i, 2], ])/sqrt(sum(EBN14[EBN_2014_P[i, 1], 
        ]^2) * sum(EBN14[EBN_2014_P[i, 2], ]^2))

# Czekanowski
EBN_2014_C <- cbind(t(combn(rownames(EBN14), 2)), 0)
    for (i in 1:nrow(EBN_2014_C)) EBN_2014_C[i, 3] <- 1 - 0.5 * sum(abs((EBN14[EBN_2014_C[i, 
        1], ] - EBN14[EBN_2014_C[i, 2], ])))

plot(EBN_2014_P[,3], EBN_2014_C[,3],
     main = "Niche Overlap Probabilities, EBN in 2014",
     xlab =  "Pianka",
     ylab = "Czekanowski",
     pch = 3)
  mtext("(Each cross symbolizes one pair of species)")
```

For EBN, 2015.
```{r, results='hide'}
# Pianka and Czekanowski analysis for EBN, 2015

# Setting the input data
EBN15 <- EBN_2015_cast/rowSums(EBN_2015_cast)

# Pianka
EBN_2015_P <- cbind(t(combn(rownames(EBN15), 2)), 0)
    for (i in 1:nrow(EBN_2015_P)) EBN_2015_P[i, 3] <- sum(EBN15[EBN_2015_P[i, 
        1], ] * EBN15[EBN_2015_P[i, 2], ])/sqrt(sum(EBN15[EBN_2015_P[i, 1], 
        ]^2) * sum(EBN15[EBN_2015_P[i, 2], ]^2))

# Czekanowski
EBN_2015_C <- cbind(t(combn(rownames(EBN15), 2)), 0)
    for (i in 1:nrow(EBN_2015_C)) EBN_2015_C[i, 3] <- 1 - 0.5 * sum(abs((EBN15[EBN_2015_C[i, 
        1], ] - EBN15[EBN_2015_C[i, 2], ])))

plot(EBN_2015_P[,3], EBN_2015_C[,3],
     main = "Niche Overlap Probabilities, EBN in 2015",
     xlab =  "Pianka",
     ylab = "Czekanowski",
     pch = 3)
  mtext("(Each cross symbolizes one pair of species)")
```

For PP, 2010.
```{r, results='hide'}
# Pianka and Czekanowski analysis for PP, 2010

# Setting the input data
PP10 <- PP_2010_cast/rowSums(PP_2010_cast)

# Pianka
PP_2010_P <- cbind(t(combn(rownames(PP10), 2)), 0)
    for (i in 1:nrow(PP_2010_P)) PP_2010_P[i, 3] <- sum(PP10[PP_2010_P[i, 
        1], ] * PP10[PP_2010_P[i, 2], ])/sqrt(sum(PP10[PP_2010_P[i, 1], 
        ]^2) * sum(PP10[PP_2010_P[i, 2], ]^2))

# Czekanowski
PP_2010_C <- cbind(t(combn(rownames(PP10), 2)), 0)
    for (i in 1:nrow(PP_2010_C)) PP_2010_C[i, 3] <- 1 - 0.5 * sum(abs((PP10[PP_2010_C[i, 
        1], ] - PP10[PP_2010_C[i, 2], ])))

plot(PP_2010_P[,3], PP_2010_C[,3],
     main = "Niche Overlap Probabilities, PP in 2010",
     xlab =  "Pianka",
     ylab = "Czekanowski",
     pch = 3)
  mtext("(Each cross symbolizes one pair of species)")
```

For PP, 2013.
```{r, results='hide'}
# Pianka and Czekanowski analysis for PP, 2013

# Setting the input data
PP13 <- PP_2013_cast/rowSums(PP_2013_cast)

# Pianka
PP_2013_P <- cbind(t(combn(rownames(PP13), 2)), 0)
    for (i in 1:nrow(PP_2013_P)) PP_2013_P[i, 3] <- sum(PP13[PP_2013_P[i, 
        1], ] * PP13[PP_2013_P[i, 2], ])/sqrt(sum(PP13[PP_2013_P[i, 1], 
        ]^2) * sum(PP13[PP_2013_P[i, 2], ]^2))

# Czekanowski
PP_2013_C <- cbind(t(combn(rownames(PP13), 2)), 0)
    for (i in 1:nrow(PP_2013_C)) PP_2013_C[i, 3] <- 1 - 0.5 * sum(abs((PP13[PP_2013_C[i, 
        1], ] - PP13[PP_2013_C[i, 2], ])))

plot(PP_2013_P[,3], PP_2013_C[,3],
     main = "Niche Overlap Probabilities, PP in 2013",
     xlab =  "Pianka",
     ylab = "Czekanowski",
     pch = 3)
  mtext("(Each cross symbolizes one pair of species)")
```

For PP, 2015.
```{r, results='hide'}
# Pianka and Czekanowski analysis for PP, 2015

# Setting the input data
PP15 <- PP_2015_cast/rowSums(PP_2015_cast)

# Pianka
PP_2015_P <- cbind(t(combn(rownames(PP15), 2)), 0)
    for (i in 1:nrow(PP_2015_P)) PP_2015_P[i, 3] <- sum(PP15[PP_2015_P[i, 
        1], ] * PP15[PP_2015_P[i, 2], ])/sqrt(sum(PP15[PP_2015_P[i, 1], 
        ]^2) * sum(PP15[PP_2015_P[i, 2], ]^2))

# Czekanowski
PP_2015_C <- cbind(t(combn(rownames(PP15), 2)), 0)
    for (i in 1:nrow(PP_2015_C)) PP_2015_C[i, 3] <- 1 - 0.5 * sum(abs((PP15[PP_2015_C[i, 
        1], ] - PP15[PP_2015_C[i, 2], ])))

plot(PP_2015_P[,3], PP_2015_C[,3],
     main = "Niche Overlap Probabilities, PP in 2015",
     xlab =  "Pianka",
     ylab = "Czekanowski",
     pch = 3)
  mtext("(Each cross symbolizes one pair of species)")
  lines(PP15, col = "red")
  abline(0,1, col = "orange")
```





- - - - - - - - - -
# Results

